"0",""
"0","#plot_composition <- TE_computation %>%"
"0","#  # Convert to long data"
"0","#  pivot_longer(c(D, N, TE, C, Du, Nu), names_to = ""vocab_type"", values_to = ""number"") %>%"
"0","#  filter(vocab_type %notin% c(""D"", ""N"", ""C"")) %>%"
"0","#  mutate(vocab_type = factor(vocab_type, levels=c(""TE"", ""Du"", ""Nu""))) %>%"
"0","#  mutate(bin_W = cut(W, breaks = 3, "
"0","#                     labels = c(""0-400"", ""401-800"", ""801-1200""))) %>%"
"0","#  group_by(bin_W, vocab_type, B) %>%"
"0","#  summarise(n_words = mean(number)) %>%"
"0","#  ggplot(aes(x=B, y = n_words, fill = vocab_type)) + "
"0","#  geom_bar(position=""stack"", stat=""identity"") +"
"0","#  facet_grid(. ~ bin_W) +"
"0","#  #scale_y_continuous(limits = c(0, 1200)) +"
"0","#  theme_minimal() +"
"0","#  theme(axis.text.x = element_text(angle = 90), legend.position = ""bottom"") + "
"0","#  labs(x = ""Balance"", "
"0","#       y = ""Number of words"") "
"0",""
"0",""
"0","plot_composition <- TE_computation %>%"
"0","  # Convert to long data"
"0","  pivot_longer(c(D, N, TE, C, Du, Nu), names_to = ""vocab_type"", values_to = ""number"") %>%"
"0","  filter(vocab_type %notin% c(""D"", ""N"", ""C"")) %>%"
"0","  mutate(vocab_type = factor(vocab_type, levels=c(""Nu"", ""Du"", ""TE""))) %>%"
"0","  mutate(bin_B = cut(B, breaks = 5, "
"0","                     labels = c(""0.5"", ""0.6"", ""0.7"", ""0.8"", ""0.9""))) %>%"
"0","  group_by(bin_B, vocab_type, W) %>%"
"0","  summarise(n_words = mean(number)) %>%"
"0","  ggplot(aes(x=W, y = n_words, fill = vocab_type)) + "
"0","  geom_bar(position=""stack"", stat=""identity"") +"
"0","  facet_grid(. ~ bin_B) +"
"0","  scale_fill_manual(values = c(""#1f78b4"", ""#a6cee3"", ""#33a02c"")) + "
"0","  #scale_y_continuous(limits = c(0, 1200)) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 90), legend.position = ""bottom"") + "
"0","  labs(x = ""Total vocabulary size"", "
"0","       y = ""Number of words"", "
"0","       title = ""Vocabulary composition across different balance proportions"") "
"2","pivot_longer: reorganized (D, N, TE, C, Du, â€¦) into (vocab_type, number) [was 197x9, now 1182x5]
"
"2","filter: removed 591 rows (50%), 591 rows remaining
"
"2","mutate: converted 'vocab_type' from character to factor (0 new NA)
"
"2","mutate: new variable 'bin_B' (factor) with 5 unique values and 0% NA
"
"2","group_by: 3 grouping variables (bin_B, vocab_type, W)
"
"2","summarise: now 276 rows and 4 columns, 2 group variables remaining (bin_B, vocab_type)
"
"0","ggsave(""plot_composition.png"", plot_composition)"
"2","Saving 7 x 7 in image
"
